import asyncio; import aiohttp; import time; import sys; async def benchmark_throughput(url, concurrent=10, duration=60): successful = 0; failed = 0; start = time.time(); async with aiohttp.ClientSession() as session: while time.time() - start < duration: tasks = [session.get(url) for _ in range(concurrent)]; results = await asyncio.gather(*tasks, return_exceptions=True); successful += sum(1 for r in results if hasattr(r, "status") and 200 <= r.status < 300); failed += sum(1 for r in results if not hasattr(r, "status") or r.status >= 300); actual_duration = time.time() - start; rps = successful / actual_duration; print({"rps": rps, "successful": successful, "failed": failed, "duration": actual_duration}); return rps; asyncio.run(benchmark_throughput(sys.argv[1], int(sys.argv[2]) if len(sys.argv) > 2 else 10, int(sys.argv[3]) if len(sys.argv) > 3 else 60)) if len(sys.argv) > 1 else print("Usage: python throughput_test.py <url> [concurrent] [duration]")
